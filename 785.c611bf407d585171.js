"use strict";(self.webpackChunkcic_task=self.webpackChunkcic_task||[]).push([[785],{4785:(M,u,a)=>{a.r(u),a.d(u,{CitiesModule:()=>N});var m=a(6895),h=a(4466),d=a(2655),r=a(433),t=a(8256),p=a(2790),y=a(1135);let f=(()=>{class i{constructor(){this.cities$=new y.X([{id:0,country:"Egypt",name:"Cairo",code:"#045"},{id:1,country:"Egypt",name:"Giza",code:"#048"}])}getCities$(){return this.cities$.asObservable()}getLastCityId(){let e=0;return this.cities$.getValue().forEach(o=>{o.id>e&&(e=o.id)}),e}addOrUpdateCity(e){let o=this.cities$.getValue();const s=o.findIndex(({id:l})=>e.id===l);if(-1===s)return void this.cities$.next([...o,{...e,id:this.getLastCityId()+1}]);const c=[...o];c[s]=e,this.cities$.next(c)}delete(e){const s=this.cities$.getValue().filter(c=>c.id!=e);this.cities$.next(s)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var C=a(9987);function g(i,n){if(1&i&&(t.TgZ(0,"th",4),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function _(i,n){if(1&i&&(t.TgZ(0,"td",6),t._uU(1),t.qZA()),2&i){const e=n.$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(o[e.id])}}function F(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"tr"),t.YNc(1,_,2,1,"td",5),t.TgZ(2,"td",6)(3,"div",7)(4,"button",8),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onClickAction.emit({action:"edit",data:c}))}),t._UZ(5,"i",9),t.qZA(),t.TgZ(6,"button",10),t.NdJ("click",function(){const c=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.onClickAction.emit({action:"delete",data:c}))}),t._UZ(7,"i",11),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.columns)}}let b=(()=>{class i{constructor(){this.columns=[],this.onClickAction=new t.vpe}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["data-table"]],inputs:{columns:"columns",data:"data"},outputs:{onClickAction:"onClickAction"},decls:7,vars:2,consts:[[1,"table","curved","table-hover","table-responsive","table-striped"],["scope","col",4,"ngFor","ngForOf"],[1,"header-cell"],[4,"ngFor","ngForOf"],["scope","col"],["class","cell",4,"ngFor","ngForOf"],[1,"cell"],[1,"d-flex","justify-content-center"],[1,"btn","btn-sm","btn-info",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],[1,"btn","btn-sm","ms-2","btn-danger",3,"click"],["aria-hidden","true",1,"fa","fa-trash-o"]],template:function(e,o){1&e&&(t.TgZ(0,"table",0)(1,"thead")(2,"tr"),t.YNc(3,g,2,1,"th",1),t._UZ(4,"th",2),t.qZA()(),t.TgZ(5,"tbody"),t.YNc(6,F,8,1,"tr",3),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngForOf",o.columns),t.xp6(3),t.Q6J("ngForOf",o.data))},dependencies:[m.sg],changeDetection:0}),i})();var v=a(5307);function Z(i,n){1&i&&(t.TgZ(0,"h2"),t._uU(1,"Add city"),t.qZA())}function T(i,n){1&i&&(t.TgZ(0,"h2"),t._uU(1,"Edit city"),t.qZA())}let A=(()=>{class i{constructor(e,o,s){this._vs=e,this._ms=o,this._cs=s,this.validationMessages={country:{required:"Country is required"},name:{required:"City is required"}},this.formErrors={},this.isEdit=!1}ngOnInit(){this.initFormGroup(),this.trackFormChanges(),this.city&&(this.isEdit=!0,this.setFormValue(this.city))}initFormGroup(){this.cityForm=new r.cw({country:new r.NI(null,r.kI.required),name:new r.NI(null,r.kI.required),code:new r.NI})}setFormValue(e){this.cityForm.patchValue({...e})}trackFormChanges(){this.cityForm.valueChanges.subscribe(e=>{this.logValidationMessages()})}logValidationMessages(){this.formErrors=this._vs.getValidationErrors(this.cityForm,this.validationMessages)}submit(){if(console.log(this.cityForm.value),this.cityForm.valid){const e=this.isEdit?{id:this.city.id,...this.cityForm.value}:this.cityForm.value;this._cs.addOrUpdateCity(e),this.close()}else this.cityForm.markAllAsTouched(),this.cityForm.markAsDirty(),this.logValidationMessages()}close(){this._ms.close()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(v.R),t.Y36(p.Z),t.Y36(f))},i.\u0275cmp=t.Xpm({type:i,selectors:[["city-form"]],inputs:{city:"city"},decls:12,vars:7,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],["formControlName","country","label","Country",3,"formControlError"],["formControlName","name","label","City",1,"mt-2",3,"formControlError"],["formControlName","code","label","Code",1,"mt-2",3,"formControlError"],[1,"mt-4","float-end"],["type","button",1,"btn","btn-secondary","px-3",3,"click"],[1,"btn","btn-primary","px-3","ms-2"]],template:function(e,o){1&e&&(t.TgZ(0,"div"),t.YNc(1,Z,2,0,"h2",0),t.YNc(2,T,2,0,"h2",0),t.qZA(),t.TgZ(3,"form",1),t.NdJ("ngSubmit",function(){return o.submit()}),t._UZ(4,"text-input",2)(5,"text-input",3)(6,"text-input",4),t.TgZ(7,"div",5)(8,"button",6),t.NdJ("click",function(){return o.close()}),t._uU(9," Close "),t.qZA(),t.TgZ(10,"button",7),t._uU(11),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("ngIf",!o.isEdit),t.xp6(1),t.Q6J("ngIf",o.isEdit),t.xp6(1),t.Q6J("formGroup",o.cityForm),t.xp6(1),t.Q6J("formControlError",o.formErrors.country),t.xp6(1),t.Q6J("formControlError",o.formErrors.name),t.xp6(1),t.Q6J("formControlError",o.formErrors.code),t.xp6(5),t.hij(" ",o.isEdit?"Edit":"Add"," "))},dependencies:[C.t,r._Y,r.JJ,r.JL,r.sg,r.u,m.O5],changeDetection:0}),i})(),w=(()=>{class i{transform(e,o,...s){return e?o?(o=o?.toLocaleLowerCase(),e.filter(c=>s.find(l=>c[l]?.toLocaleLowerCase().includes(o)))):e:[]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=t.Yjl({name:"filter",type:i,pure:!0}),i})();const x=["cityForm"];function k(i,n){if(1&i&&(t.TgZ(0,"div",9),t._UZ(1,"city-form",10),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("city",e.city)}}const J=[{path:"",component:(()=>{class i{constructor(e,o){this._ms=e,this._cs=o,this.columns=[{name:"Country",id:"country"},{name:"City",id:"name"},{name:"Code",id:"code"}]}ngOnInit(){this.initFormGroup(),this.data=this._cs.getCities$()}openCityModal(e){this.city=e,this._ms.open(this.cityForm)}initFormGroup(){this.formGroup=new r.cw({search:new r.NI})}onClickActionTable({action:e,data:o}){switch(e){case"edit":this.openCityModal(o);break;case"delete":this._cs.delete(o.id)}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.Z),t.Y36(f))},i.\u0275cmp=t.Xpm({type:i,selectors:[["view"]],viewQuery:function(e,o){if(1&e&&t.Gf(x,5),2&e){let s;t.iGM(s=t.CRH())&&(o.cityForm=s.first)}},decls:15,vars:10,consts:[[1,"container","mt-4"],[1,"row","mt-4"],[1,"col-lg-4",3,"formGroup"],["formControlName","search","placeholder","search here..."],[1,"col-lg-1","col-sm-3","mt-sm-2","mt-lg-0","ms-auto"],[1,"btn","w-100","btn-primary",3,"click"],[1,"mt-2"],[3,"columns","data","onClickAction"],["cityForm",""],[1,"modal-body"],[3,"city"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"Cities"),t.qZA(),t.TgZ(3,"div",1)(4,"div",2),t._UZ(5,"text-input",3),t.qZA(),t.TgZ(6,"div",4)(7,"button",5),t.NdJ("click",function(){return o.openCityModal(null)}),t._uU(8," Add "),t.qZA()(),t.TgZ(9,"div",6)(10,"data-table",7),t.NdJ("onClickAction",function(c){return o.onClickActionTable(c)}),t.ALo(11,"filter"),t.ALo(12,"async"),t.qZA()()()(),t.YNc(13,k,2,1,"ng-template",null,8,t.W1O)),2&e&&(t.xp6(4),t.Q6J("formGroup",o.formGroup),t.xp6(6),t.Q6J("columns",o.columns)("data",t.gM2(11,3,t.lcZ(12,8,o.data),o.formGroup.controls.search.value,"country","name")))},dependencies:[C.t,r.JJ,r.JL,r.sg,r.u,b,A,m.Ov,w],changeDetection:0}),i})()}];let E=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[d.Bz.forChild(J),d.Bz]}),i})(),N=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.m,m.ez,E]}),i})()}}]);